<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Catatan Utangku</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #eef2f5;
    margin: 0;
    padding: 20px;
  }
  h1 {
    text-align: center;
    color: #2c3e50;
  }
  .form-container {
    background: white;
    padding: 15px;
    border-radius: 10px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    max-width: 400px;
    margin: 0 auto 20px auto;
  }
  label {
    display: block;
    margin-top: 10px;
    color: #333;
  }
  input, textarea, button {
    width: 100%;
    padding: 8px;
    margin-top: 5px;
    border: 1px solid #ccc;
    border-radius: 6px;
    box-sizing: border-box;
  }
  button {
    background: #2ecc71;
    color: white;
    border: none;
    font-weight: bold;
    cursor: pointer;
    margin-top: 15px;
  }
  button:hover {
    background: #27ae60;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    background: white;
    border-radius: 10px;
    overflow: hidden;
  }
  th, td {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: center;
  }
  th {
    background: #3498db;
    color: white;
  }
  td button {
    width: 60px;
    padding: 5px;
    margin: 2px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 12px;
    color: white;
  }
  .edit-btn {
    background-color: #f1c40f;
  }
  .hapus-btn {
    background-color: #e74c3c;
  }
  .edit-btn:hover {
    background-color: #d4ac0d;
  }
  .hapus-btn:hover {
    background-color: #c0392b;
  }
  .total-container {
    background: white;
    margin-top: 15px;
    padding: 10px;
    border-radius: 8px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    text-align: right;
    font-size: 18px;
    font-weight: bold;
    color: #2c3e50;
  }
</style>
</head>
<body>

<h1>ðŸ“˜ Catatan Utangku</h1>

<div class="form-container">
  <input type="hidden" id="editIndex">
  
  <label for="tanggal">Tanggal:</label>
  <input type="date" id="tanggal">

  <label for="jumlah">Jumlah Uang (Rp):</label>
  <input type="number" id="jumlah" placeholder="Contoh: 50000">

  <label for="keterangan">Keterangan:</label>
  <textarea id="keterangan" rows="2" placeholder="Contoh: Utang ke teman, bayar listrik, dll"></textarea>

  <button id="btnSimpan" onclick="tambahData()">Tambah Catatan</button>
</div>

<table id="tabelUtang">
  <thead>
    <tr>
      <th>No</th>
      <th>Tanggal</th>
      <th>Jumlah (Rp)</th>
      <th>Keterangan</th>
      <th>Aksi</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<div class="total-container" id="totalUtang">Total Utang: Rp 0</div>

<script>
  const tabel = document.getElementById("tabelUtang").getElementsByTagName("tbody")[0];
  const totalEl = document.getElementById("totalUtang");
  let daftarUtang = JSON.parse(localStorage.getItem("daftarUtang")) || [];
  let editIndex = -1;

  // Set tanggal otomatis hari ini
  document.getElementById("tanggal").valueAsDate = new Date();

  // Render awal dari localStorage
  renderTabel();

  function renderTabel() {
    tabel.innerHTML = "";
    daftarUtang.forEach((data, index) => {
      const baris = tabel.insertRow();
      baris.insertCell(0).textContent = index + 1;
      baris.insertCell(1).textContent = data.tanggal;
      baris.insertCell(2).textContent = "Rp " + parseInt(data.jumlah).toLocaleString();
      baris.insertCell(3).textContent = data.keterangan;

      const aksiCell = baris.insertCell(4);
      aksiCell.innerHTML = `
        <button class="edit-btn" onclick="editData(${index})">Edit</button>
        <button class="hapus-btn" onclick="hapusData(${index})">Hapus</button>
      `;
    });

    hitungTotal();
    simpanData();
  }

  function tambahData() {
    const tanggal = document.getElementById("tanggal").value;
    const jumlah = document.getElementById("jumlah").value;
    const keterangan = document.getElementById("keterangan").value;

    if (!tanggal || !jumlah) {
      alert("Tanggal dan jumlah wajib diisi!");
      return;
    }

    const data = { tanggal, jumlah, keterangan };

    if (editIndex === -1) {
      daftarUtang.push(data);
    } else {
      daftarUtang[editIndex] = data;
      editIndex = -1;
      document.getElementById("btnSimpan").textContent = "Tambah Catatan";
    }

    renderTabel();
    resetForm();
  }

  function editData(index) {
    const data = daftarUtang[index];
    document.getElementById("tanggal").value = data.tanggal;
    document.getElementById("jumlah").value = data.jumlah;
    document.getElementById("keterangan").value = data.keterangan;
    document.getElementById("btnSimpan").textContent = "Simpan Perubahan";
    editIndex = index;
  }

  function hapusData(index) {
    if (confirm("Yakin ingin menghapus catatan ini?")) {
      daftarUtang.splice(index, 1);
      renderTabel();
    }
  }

  function resetForm() {
    document.getElementById("jumlah").value = "";
    document.getElementById("keterangan").value = "";
    document.getElementById("tanggal").valueAsDate = new Date();
  }

  function hitungTotal() {
    let total = 0;
    daftarUtang.forEach(item => total += parseInt(item.jumlah || 0));
    totalEl.textContent = "Total Utang: Rp " + total.toLocaleString();
  }

  function simpanData() {
    localStorage.setItem("daftarUtang", JSON.stringify(daftarUtang));
  }
</script>

</body>
</html>